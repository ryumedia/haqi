<!DOCTYPE html>
<html lang="id" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrasi Kegiatan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
    <style>
        body {
            box-sizing: border-box;
            width: 360px;
            height: 640px;
            margin: 0 auto;
            overflow: hidden;
            position: relative;
            left: 50%;
            transform: translateX(-50%);
        }
        .qr-code {
            width: 150px;
            height: 150px;
            background: white;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-600 to-emerald-800 font-sans">
    <main class="h-full flex flex-col">
        <!-- Header -->
        <header class="bg-green-800/20 backdrop-blur-sm p-3 text-center border-b border-green-300/20">
            <img src="https://blogger.googleusercontent.com/img/a/AVvXsEj73RW53O3BQuQdL07frUji9vbVo8MWkPBuNpWCV_GEMFglevINHdtpEfIMfHCkwlx7un1m7rCvEH1u7VzFZFVXgRvgd8JldQEO0c8WS5l9S41DOBYoUQ9J-BX4zmku9_DRipeMkNezZsgUtAIwEsEs6MgiblgrZ3pv1lNAMH-h2nTg3IG4t12Amwv570k" alt="Logo KOTAQU" class="w-20 h-20 mx-auto mb-2 rounded-full" onerror="this.src=''; this.alt='Logo gagal dimuat'; this.style.display='none';">
            <h1 class="text-lg font-bold text-white">Halaqoh Qur'ani (HAQI) 2</h1>
            <p class="text-white/90 text-xs font-medium">KOTAQU (Komunitas Pecinta Qur'an)</p>
            <p class="text-white/80 text-xs mt-1">Masukkan nama untuk mendapatkan QR Code</p>
        </header>

        <!-- Content Area -->
        <div class="flex-1 flex flex-col justify-center px-4 py-2">
            <!-- Registration Form -->
            <div id="registrationForm" class="bg-white rounded-xl shadow-xl p-4 mb-3">
                <form id="regForm" class="space-y-3">
                    <!-- Status Registrasi -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Status Registrasi
                        </label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input 
                                    type="radio" 
                                    name="registrationStatus" 
                                    value="sudah_daftar"
                                    class="mr-2 text-green-600 focus:ring-green-500"
                                    onchange="toggleRegistrationFields()"
                                >
                                <span class="text-sm text-gray-700">Sudah Daftar</span>
                            </label>
                            <label class="flex items-center">
                                <input 
                                    type="radio" 
                                    name="registrationStatus" 
                                    value="belum_daftar"
                                    class="mr-2 text-green-600 focus:ring-green-500"
                                    onchange="toggleRegistrationFields()"
                                >
                                <span class="text-sm text-gray-700">Belum Daftar</span>
                            </label>
                        </div>
                    </div>

                    <!-- Form untuk Belum Daftar -->
                    <div id="newRegistrationFields" class="space-y-3 hidden">
                        <div>
                            <label for="participantName" class="block text-sm font-medium text-gray-700 mb-1">
                                Nama Lengkap
                            </label>
                            <input 
                                type="text" 
                                id="participantName" 
                                name="participantName"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-base"
                                placeholder="Masukkan nama lengkap Anda"
                            >
                        </div>

                        <div>
                            <label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-1">
                                Nomor HP
                            </label>
                            <input 
                                type="tel" 
                                id="phoneNumber" 
                                name="phoneNumber"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-base"
                                placeholder="Contoh: 08123456789"
                            >
                        </div>

                        <div>
                            <label for="kecamatan" class="block text-sm font-medium text-gray-700 mb-1">
                                Kecamatan
                            </label>
                            <select 
                                id="kecamatan" 
                                name="kecamatan"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-base"
                            >
                                <option value="">Pilih Kecamatan</option>
                                <option value="UJUNGBERUNG">UJUNGBERUNG</option>
                                <option value="CINAMBO">CINAMBO</option>
                            </select>
                        </div>

                        <div>
                            <label for="kelurahan" class="block text-sm font-medium text-gray-700 mb-1">
                                Kelurahan
                            </label>
                            <select 
                                id="kelurahan" 
                                name="kelurahan"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-base"
                            >
                                <option value="">Pilih Kelurahan</option>
                                <option value="PASIRENDAH">PASIRENDAH</option>
                                <option value="CIGENDING">CIGENDING</option>
                                <option value="PASIRWANGI">PASIRWANGI</option>
                                <option value="PASIRJATI">PASIRJATI</option>
                                <option value="PASANGGRAHAN">PASANGGRAHAN</option>
                                <option value="BABAKAN PENGHULU">BABAKAN PENGHULU</option>
                                <option value="CISARANTEN WETAN">CISARANTEN WETAN</option>
                                <option value="PAKEMITAN">PAKEMITAN</option>
                                <option value="SUKAMULYA">SUKAMULYA</option>
                            </select>
                        </div>
                    </div>

                    <!-- Form untuk Sudah Daftar -->
                    <div id="existingRegistrationFields" class="space-y-3 hidden">
                        <div>
                            <label for="existingParticipant" class="block text-sm font-medium text-gray-700 mb-1">
                                Pilih Nama Lengkap
                            </label>
                            <select 
                                id="existingParticipant" 
                                name="existingParticipant"
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-base"
                                onchange="showParticipantInfo()"
                            >
                                <option value="">Pilih Nama Peserta</option>
                                <option value="0">Achmad Ghozali</option>
                                <option value="1">Adilla Sayyeda Khadija</option>
                                <option value="2">Aisyah</option>
                                <option value="3">Almira Naaz Abdillah</option>
                                <option value="4">Amah</option>
                                <option value="5">Anita Asmara</option>
                                <option value="6">Ati Supriyati</option>
                                <option value="7">ayi gustaman</option>
                                <option value="8">Burhan Nurhasan</option>
                                <option value="9">Dati Damilah</option>
                                <option value="10">Dodi Gunadi</option>
                                <option value="11">Elly Herlina</option>
                                <option value="12">Euis Sholihah</option>
                                <option value="13">Fani Afriyani Susilawati</option>
                                <option value="14">Fera Berliani</option>
                                <option value="15">Imas Asaroh</option>
                                <option value="16">Inu yuniarti</option>
                                <option value="17">Kartika Una Juwita</option>
                                <option value="18">Lailla Kodryati</option>
                                <option value="19">Murniati</option>
                                <option value="20">Nenden Heny Hermayanti</option>
                                <option value="21">Ngatini</option>
                                <option value="22">Nining holilah</option>
                                <option value="23">Ninuk Minarsih</option>
                                <option value="24">Novianti</option>
                                <option value="25">Nur Aemi</option>
                                <option value="26">Nurdini homsah</option>
                                <option value="27">Nurhalimah</option>
                                <option value="28">Nurrachmah</option>
                                <option value="29">oky christianingrum</option>
                                <option value="30">Ratih Kesuma Dewi</option>
                                <option value="31">Retno Fadilah</option>
                                <option value="32">Rina Marinnisa</option>
                                <option value="33">Rosalia Soepena</option>
                                <option value="34">Sandra Chendrawasih</option>
                                <option value="35">Saripudin</option>
                                <option value="36">Siti Aminah</option>
                                <option value="37">Siti Mariah R</option>
                                <option value="38">Siti Patonah</option>
                                <option value="39">Sri Gustiany Dewi</option>
                                <option value="40">Tuti Mirawati</option>
                                <option value="41">Yan Alfaroby</option>
                                <option value="42">Yanti fatmawati</option>
                                <option value="43">Yarnes Syam</option>
                                <option value="44">Yuyu yutini</option>
                            </select>
                        </div>

                        <!-- Info Peserta -->
                        <div id="participantInfo" class="bg-gray-50 p-3 rounded-lg hidden">
                            <h3 class="text-sm font-semibold text-gray-800 mb-2">Informasi Peserta:</h3>
                            <div class="space-y-1 text-sm text-gray-700">
                                <p><span class="font-medium">Nama Lengkap:</span> <span id="infoName">-</span></p>
                                <p><span class="font-medium">Nomor WA:</span> <span id="infoPhone">-</span></p>
                                <p><span class="font-medium">Kecamatan:</span> <span id="infoKecamatan">-</span></p>
                                <p><span class="font-medium">Kelurahan:</span> <span id="infoKelurahan">-</span></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Error Message -->
                    <div id="errorMessage" class="hidden bg-red-100 border border-red-400 text-red-700 px-3 py-2 rounded text-sm">
                    </div>
                    
                    <button 
                        type="submit"
                        id="submitButton"
                        class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 text-base disabled:bg-gray-400"
                        disabled
                    >
                        Daftar Sekarang
                    </button>
                </form>
            </div>

            <!-- QR Code Result -->
            <div id="qrResult" class="bg-white rounded-xl shadow-xl p-4 hidden">
                <div class="text-center">
                    <div class="mb-3">
                        <h2 class="text-gray-600 text-sm">Ahlan Wasahlan, <span id="registeredName" class="font-semibold text-green-600"></span></h2>
			<p class="text-lg font-bold text-gray-800 mb-1">Tunjukan QR Code ini ke Panitia</p>
                        
                    </div>
                    
                    <!-- QR Code Display -->
                    <div class="qr-code rounded-lg mb-3" id="qrCodeDisplay">
                        <canvas id="qrCanvas" width="150" height="150"></canvas>
                    </div>
                    
                    <div class="text-xs text-gray-500 mb-3">
                        <p>ID Peserta: <span id="participantId" class="font-mono font-semibold"></span></p>
                        <p>Waktu Registrasi: <span id="registrationTime"></span></p>
                    </div>
                    
                    <button 
                        onclick="resetForm()"
                        class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 text-sm"
                    >
                        Daftar Peserta Lain
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="bg-green-800/20 backdrop-blur-sm p-2 text-center border-t border-green-300/20">
            <p class="text-white/70 text-xs">© 2025 KOTAQU - Komunitas Pecinta Qur'an</p>
        </footer>
    </main>

    <script>
        // Data peserta yang sudah terdaftar (diurutkan alfabetis)
        const existingParticipants = [
            {name: "Achmad Ghozali", phone: "085224131324", kecamatan: "UJUNGBERUNG", kelurahan: "PASANGGRAHAN"},
            {name: "Adilla Sayyeda Khadija", phone: "087846445131", kecamatan: "UJUNGBERUNG", kelurahan: "PASANGGRAHAN"},
            {name: "Aisyah", phone: "082240031311", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Almira Naaz Abdillah", phone: "081573344909", kecamatan: "UJUNGBERUNG", kelurahan: "PASANGGRAHAN"},
            {name: "Amah", phone: "089647050032", kecamatan: "CINAMBO", kelurahan: "SUKAMULYA"},
            {name: "Anita Asmara", phone: "081546925706", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Ati Supriyati", phone: "081282248160", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "ayi gustaman", phone: "089654813199", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Burhan Nurhasan", phone: "08815729350", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Dati Damilah", phone: "089606440220", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRWANGI"},
            {name: "Dodi Gunadi", phone: "082227033385", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Elly Herlina", phone: "082110020267", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Euis Sholihah", phone: "085695988551", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Fani Afriyani Susilawati", phone: "082129269513", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Fera Berliani", phone: "085134229323", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Imas Asaroh", phone: "085798427802", kecamatan: "UJUNGBERUNG", kelurahan: "CIGENDING"},
            {name: "Inu yuniarti", phone: "087750011312", kecamatan: "UJUNGBERUNG", kelurahan: "PASANGGRAHAN"},
            {name: "Kartika Una Juwita", phone: "081546449154", kecamatan: "CINAMBO", kelurahan: "CISARANTEN WETAN"},
            {name: "Lailla Kodryati", phone: "087876894603", kecamatan: "UJUNGBERUNG", kelurahan: "CIGENDING"},
            {name: "Murniati", phone: "081321038058", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRWANGI"},
            {name: "Nenden Heny Hermayanti", phone: "83148757815", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Ngatini", phone: "083822907972", kecamatan: "UJUNGBERUNG", kelurahan: "CIGENDING"},
            {name: "Nining holilah", phone: "081280198064", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Ninuk Minarsih", phone: "087821982244", kecamatan: "UJUNGBERUNG", kelurahan: "CIGENDING"},
            {name: "Novianti", phone: "081287177377", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Nur Aemi", phone: ".", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Nurdini homsah", phone: "089691702444", kecamatan: "UJUNGBERUNG", kelurahan: "CIGENDING"},
            {name: "Nurhalimah", phone: "085265907790", kecamatan: "CINAMBO", kelurahan: "SUKAMULYA"},
            {name: "Nurrachmah", phone: "081223539850", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRWANGI"},
            {name: "oky christianingrum", phone: "082219609600", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRWANGI"},
            {name: "Ratih Kesuma Dewi", phone: ".", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRWANGI"},
            {name: "Retno Fadilah", phone: "081322341464", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Rina Marinnisa", phone: "081321331133", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Rosalia Soepena", phone: "081310243503", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Sandra Chendrawasih", phone: "08158948557", kecamatan: "UJUNGBERUNG", kelurahan: "PASANGGRAHAN"},
            {name: "Saripudin", phone: "081573050820", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Siti Aminah", phone: "0818224720", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Siti Mariah R", phone: "085162733710", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Siti Patonah", phone: "085723529664", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Sri Gustiany Dewi", phone: "082126600337", kecamatan: "UJUNGBERUNG", kelurahan: "CIGENDING"},
            {name: "Tuti Mirawati", phone: "082111597361", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRWANGI"},
            {name: "Yan Alfaroby", phone: "081933136472", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRJATI"},
            {name: "Yanti fatmawati", phone: "081394459905", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"},
            {name: "Yarnes Syam", phone: "081298644575", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRWANGI"},
            {name: "Yuyu yutini", phone: "083193561900", kecamatan: "UJUNGBERUNG", kelurahan: "PASIRENDAH"}
        ];

        function showParticipantInfo() {
            const select = document.getElementById('existingParticipant');
            const infoDiv = document.getElementById('participantInfo');
            
            if (select.value === '') {
                infoDiv.classList.add('hidden');
                return;
            }
            
            const participant = existingParticipants[parseInt(select.value)];
            
            document.getElementById('infoName').textContent = participant.name;
            document.getElementById('infoPhone').textContent = participant.phone;
            document.getElementById('infoKecamatan').textContent = participant.kecamatan;
            document.getElementById('infoKelurahan').textContent = participant.kelurahan;
            
            infoDiv.classList.remove('hidden');
        }

        function toggleRegistrationFields() {
            const status = document.querySelector('input[name="registrationStatus"]:checked');
            const newFields = document.getElementById('newRegistrationFields');
            const existingFields = document.getElementById('existingRegistrationFields');
            const submitButton = document.getElementById('submitButton');
            
            if (status) {
                submitButton.disabled = false;
                
                if (status.value === 'belum_daftar') {
                    newFields.classList.remove('hidden');
                    existingFields.classList.add('hidden');
                    submitButton.textContent = 'Daftar Sekarang';
                } else if (status.value === 'sudah_daftar') {
                    newFields.classList.add('hidden');
                    existingFields.classList.remove('hidden');
                    submitButton.textContent = 'Generate QR Code';
                }
            } else {
                submitButton.disabled = true;
                newFields.classList.add('hidden');
                existingFields.classList.add('hidden');
            }
        }

        document.getElementById('regForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const status = document.querySelector('input[name="registrationStatus"]:checked');
            
            if (!status) {
                return;
            }
            
            let name = '';
            let phone = '';
            let kecamatan = '';
            let kelurahan = '';
            let participantId = '';
            
            if (status.value === 'belum_daftar') {
                name = document.getElementById('participantName').value.trim();
                phone = document.getElementById('phoneNumber').value.trim();
                kecamatan = document.getElementById('kecamatan').value;
                kelurahan = document.getElementById('kelurahan').value;
                
                if (!name || !phone || !kecamatan || !kelurahan) {
                    showErrorMessage('Mohon lengkapi semua field yang diperlukan');
                    return;
                }
                
                // Generate participant ID for new registration
                participantId = 'REG' + Date.now().toString().slice(-6);
            } else {
                // Logic untuk sudah daftar
                const selectedIndex = document.getElementById('existingParticipant').value;
                
                if (!selectedIndex) {
                    showErrorMessage('Mohon pilih nama peserta yang sudah terdaftar');
                    return;
                }
                
                const participant = existingParticipants[parseInt(selectedIndex)];
                name = participant.name;
                phone = participant.phone;
                kecamatan = participant.kecamatan;
                kelurahan = participant.kelurahan;
                
                // Generate participant ID for existing registration
                participantId = 'EXT' + Date.now().toString().slice(-6);
            }
            
            // Get current time
            const now = new Date();
            const timeString = now.toLocaleString('id-ID', {
                day: '2-digit',
                month: '2-digit', 
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Update QR result display
            document.getElementById('registeredName').textContent = name;
            document.getElementById('participantId').textContent = participantId;
            document.getElementById('registrationTime').textContent = timeString;
            
            // Generate QR code with CSV format
            const qrData = `${name},${phone},${kecamatan},${kelurahan}`;
            generateQRCode(qrData);
            
            // Hide form and show result
            document.getElementById('registrationForm').classList.add('hidden');
            document.getElementById('qrResult').classList.remove('hidden');
        });
        
        function generateQRCode(data) {
            const canvas = document.getElementById('qrCanvas');
            
            // Create QR code using QRious library
            const qr = new QRious({
                element: canvas,
                value: data,
                size: 150,
                background: 'white',
                foreground: 'black',
                level: 'M'
            });
        }
        
        function showErrorMessage(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            
            // Hide error message after 5 seconds
            setTimeout(() => {
                errorDiv.classList.add('hidden');
            }, 5000);
        }

        function resetForm() {
            // Reset all form fields
            document.getElementById('regForm').reset();
            
            // Hide all conditional fields
            document.getElementById('newRegistrationFields').classList.add('hidden');
            document.getElementById('existingRegistrationFields').classList.add('hidden');
            document.getElementById('participantInfo').classList.add('hidden');
            document.getElementById('errorMessage').classList.add('hidden');
            
            // Disable submit button
            document.getElementById('submitButton').disabled = true;
            document.getElementById('submitButton').textContent = 'Daftar Sekarang';
            
            // Show form and hide result
            document.getElementById('registrationForm').classList.remove('hidden');
            document.getElementById('qrResult').classList.add('hidden');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'993fe958f03be780',t:'MTc2MTM3NjQwOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
